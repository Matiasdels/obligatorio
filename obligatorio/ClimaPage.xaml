<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:converters="clr-namespace:obligatorio.Converters"
             x:Class="obligatorio.ClimaPage"
             Title="Clima"
             BackgroundColor="{StaticResource OxfordBlue}">

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="20">

            <Frame x:Name="HeaderFrame"
                   BackgroundColor="Transparent" 
                   Background="{StaticResource PrimaryGradient}" 
                   CornerRadius="20" 
                   Padding="25" 
                   Shadow="{StaticResource CardShadow}">
                <Frame.GestureRecognizers>
                    <PointerGestureRecognizer PointerEntered="OnHeaderPointerEntered" 
                                            PointerExited="OnHeaderPointerExited"/>
                </Frame.GestureRecognizers>
                <VerticalStackLayout Spacing="8">
                    <Label Text="☀️ Clima" 
                       FontSize="28" 
                       FontAttributes="Bold" 
                       TextColor="White" 
                       HorizontalOptions="Center"/>
                    <Label Text="Pronóstico actual y próximos días" 
                       FontSize="16" 
                       TextColor="White" 
                       Opacity="0.9" 
                       HorizontalOptions="Center"/>
                </VerticalStackLayout>
            </Frame>
            <Frame BackgroundColor="{StaticResource PrussianBlue}"
                   CornerRadius="20"
                   HasShadow="True"
                   Padding="20"
                   HorizontalOptions="Fill">
                
                <VerticalStackLayout Spacing="15">

                    <Label x:Name="lblCity"
                           FontSize="28"
                           FontAttributes="Bold"
                           TextColor="{StaticResource White}"
                           HorizontalOptions="Center" />

                    <HorizontalStackLayout VerticalOptions="Center" HorizontalOptions="Center" Spacing="10">
                        <Image x:Name="imgIcon"
                           HeightRequest="80"
                           WidthRequest="80"
                           VerticalOptions="Center" />
                        <Label x:Name="lblTemp"
                           FontSize="48"
                           FontAttributes="Bold"
                           TextColor="{StaticResource White}"
                           VerticalOptions="Center" />
                    </HorizontalStackLayout>

                    <Label x:Name="lblDescription"
                           FontSize="18"
                           TextColor="{StaticResource White}"
                           HorizontalOptions="Center"
                           FontAttributes="Italic" />

                </VerticalStackLayout>
            </Frame>


            <Frame BackgroundColor="{StaticResource PrussianBlue}"
                   CornerRadius="20"
                   HasShadow="True"
                   Padding="15"
                   HorizontalOptions="Fill">

                <VerticalStackLayout Spacing="15">

                    <Label Text="Próximos días"
                       FontSize="20"
                       FontAttributes="Bold"
                       TextColor="{StaticResource White}"
                       HorizontalOptions="Center"/>

                    <CollectionView x:Name="forecastCollection"
                        ItemsLayout="HorizontalList"
                        HeightRequest="180"              
                        HorizontalOptions="Center">
                        
                       
                        <CollectionView.ItemTemplate>
                            
                            <DataTemplate>
                                
                                <Frame BackgroundColor="{StaticResource Gray100}"
                                   CornerRadius="10"
                                   Padding="10"
                                   Margin="5,0"
                                   HasShadow="False"
                                   HorizontalOptions="Fill"
                                   MinimumWidthRequest="100">

                                    <Frame.GestureRecognizers>
                                        <PointerGestureRecognizer PointerEntered="OnClimaPointerEntered"
                                                                  PointerExited="OnClimaPointerExited"/>
                                    </Frame.GestureRecognizers>

                                    <Grid RowDefinitions="Auto,Auto,Auto,Auto" ColumnDefinitions="*">
                                        <Label Text="{Binding Date}" 
                                           FontSize="14" 
                                           FontAttributes="Bold"
                                           TextColor="{StaticResource PrussianBlue}"
                                           HorizontalOptions="Center"/>

                                        <Image Source="{Binding Icon}" 
                                           HeightRequest="40" 
                                           WidthRequest="40"
                                           HorizontalOptions="Center"
                                           Grid.Row="1"/>

                                        <Label Text="{Binding Temp}" 
                                           FontSize="16" 
                                           FontAttributes="Bold"
                                           TextColor="{StaticResource Gray900}"
                                           HorizontalOptions="Center"
                                           Grid.Row="2"/>

                                        <Label Text="{Binding Description}" 
                                           FontSize="11" 
                                           TextColor="{StaticResource Gray600}"
                                           HorizontalOptions="Center"
                                           LineBreakMode="WordWrap"
                                           Grid.Row="3"/>   
                                    </Grid>
                                </Frame>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>

                </VerticalStackLayout>
            </Frame>
            <Button Grid.Row="3"
                x:Name="btnAtras" 
                Text="← Volver atrás" 
                Clicked="btnAtras_Clicked"
                Style="{StaticResource AppPrimaryButton}"
                HeightRequest="45"
                Margin="20,10,20,15"/>

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>