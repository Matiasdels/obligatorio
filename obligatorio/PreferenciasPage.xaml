<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="obligatorio.PreferenciasPage"
             BackgroundColor="{AppThemeBinding Light=#F8FAFC, Dark=#0F172A}">

    <ContentPage.Resources>
        <ResourceDictionary>
            <!-- Estilos personalizados -->
            <Style x:Key="ModuleCardStyle" TargetType="Frame">
                <Setter Property="BackgroundColor" Value="{AppThemeBinding Light=White, Dark=#1E293B}" />
                <Setter Property="CornerRadius" Value="15" />
                <Setter Property="HasShadow" Value="True" />
                <Setter Property="Padding" Value="20" />
                <Setter Property="Margin" Value="0,10" />
            </Style>

            <Style x:Key="SectionTitleStyle" TargetType="Label">
                <Setter Property="FontSize" Value="20" />
                <Setter Property="FontAttributes" Value="Bold" />
                <Setter Property="TextColor" Value="#2196F3" />
                <Setter Property="Margin" Value="0,20,0,10" />
            </Style>

            <Style x:Key="ModuleTitleStyle" TargetType="Label">
                <Setter Property="FontSize" Value="16" />
                <Setter Property="FontAttributes" Value="Bold" />
                <Setter Property="TextColor" Value="{AppThemeBinding Light=#1E293B, Dark=White}" />
                <Setter Property="VerticalOptions" Value="Center" />
            </Style>

            <Style x:Key="ModuleDescriptionStyle" TargetType="Label">
                <Setter Property="FontSize" Value="14" />
                <Setter Property="TextColor" Value="{AppThemeBinding Light=#64748B, Dark=#94A3B8}" />
                <Setter Property="LineBreakMode" Value="WordWrap" />
                <Setter Property="Margin" Value="0,2,0,0" />
            </Style>

            <Style x:Key="ModernSwitchStyle" TargetType="Switch">
                <Setter Property="OnColor" Value="#2196F3" />
                <Setter Property="ThumbColor" Value="White" />
                <Setter Property="VerticalOptions" Value="Center" />
                <Setter Property="Scale" Value="1.2" />
            </Style>
        </ResourceDictionary>
    </ContentPage.Resources>

    <ScrollView>
        <StackLayout Padding="20" Spacing="0">

            <!-- Header -->
            <Frame BackgroundColor="{AppThemeBinding Light=White, Dark=#1E293B}"
                   CornerRadius="20"
                   HasShadow="True"
                   Padding="0"
                   Margin="0,0,0,20">

                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="100" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <!-- Fondo degradado del header -->
                    <Frame Grid.Row="0"
                           BackgroundColor="#2196F3"
                           CornerRadius="20,20,0,0"
                           HasShadow="False"
                           Padding="0">
                        <Grid>
                            <BoxView BackgroundColor="#1976D2" 
                                     Opacity="0.7"
                                     VerticalOptions="Fill" 
                                     HorizontalOptions="Fill" />
                        </Grid>
                    </Frame>

                    <!-- Contenido del header -->
                    <StackLayout Grid.Row="0" Grid.RowSpan="2"
                                 Padding="20"
                                 Spacing="10">

                        <!-- Icono principal -->
                        <Frame BackgroundColor="White"
                               CornerRadius="30"
                               HasShadow="True"
                               Padding="0"
                               WidthRequest="60"
                               HeightRequest="60"
                               HorizontalOptions="Center"
                               VerticalOptions="End"
                               Margin="0,0,0,-30">

                            <Label Text="📱"
                                   FontSize="30"
                                   HorizontalOptions="Center"
                                   VerticalOptions="Center" />
                        </Frame>

                        <!-- Título y descripción -->
                        <Label Text="Configurar Módulos"
                               FontSize="24"
                               FontAttributes="Bold"
                               TextColor="{AppThemeBinding Light=#1E293B, Dark=White}"
                               HorizontalOptions="Center"
                               Margin="0,40,0,0" />

                        <Label Text="Selecciona qué módulos quieres ver en tu página principal"
                               FontSize="14"
                               TextColor="{AppThemeBinding Light=#64748B, Dark=#94A3B8}"
                               HorizontalOptions="Center"
                               Margin="0,5,0,0" />
                    </StackLayout>
                </Grid>
            </Frame>

            <!-- Sección: Módulos Disponibles -->
            <Label Text="🏠 Módulos de la Página Principal" Style="{StaticResource SectionTitleStyle}" />

            <!-- Módulo Clima -->
            <Frame Style="{StaticResource ModuleCardStyle}">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <Label Grid.Column="0"
                           Text="🌤️"
                           FontSize="30"
                           VerticalOptions="Center"
                           Margin="0,0,15,0" />

                    <StackLayout Grid.Column="1"
                                 VerticalOptions="Center"
                                 Spacing="2">
                        <Label Text="Clima"
                               Style="{StaticResource ModuleTitleStyle}" />
                        <Label Text="Consulta el estado del tiempo y pronósticos"
                               Style="{StaticResource ModuleDescriptionStyle}" />
                    </StackLayout>

                    <Switch Grid.Column="2"
                            IsToggled="{Binding PreferenciasActuales.MostrarClima}"
                            Style="{StaticResource ModernSwitchStyle}" />
                </Grid>
            </Frame>

            <!-- Módulo Cotizaciones -->
            <Frame Style="{StaticResource ModuleCardStyle}">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <Label Grid.Column="0"
                           Text="💱"
                           FontSize="30"
                           VerticalOptions="Center"
                           Margin="0,0,15,0" />

                    <StackLayout Grid.Column="1"
                                 VerticalOptions="Center"
                                 Spacing="2">
                        <Label Text="Cotizaciones"
                               Style="{StaticResource ModuleTitleStyle}" />
                        <Label Text="Ve las cotizaciones actuales de divisas"
                               Style="{StaticResource ModuleDescriptionStyle}" />
                    </StackLayout>

                    <Switch Grid.Column="2"
                            IsToggled="{Binding PreferenciasActuales.MostrarCotizaciones}"
                            Style="{StaticResource ModernSwitchStyle}" />
                </Grid>
            </Frame>

            <!-- Módulo Noticias -->
            <Frame Style="{StaticResource ModuleCardStyle}">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <Label Grid.Column="0"
                           Text="📰"
                           FontSize="30"
                           VerticalOptions="Center"
                           Margin="0,0,15,0" />

                    <StackLayout Grid.Column="1"
                                 VerticalOptions="Center"
                                 Spacing="2">
                        <Label Text="Noticias"
                               Style="{StaticResource ModuleTitleStyle}" />
                        <Label Text="Mantente al día con las últimas noticias"
                               Style="{StaticResource ModuleDescriptionStyle}" />
                    </StackLayout>

                    <Switch Grid.Column="2"
                            IsToggled="{Binding PreferenciasActuales.MostrarNoticias}"
                            Style="{StaticResource ModernSwitchStyle}" />
                </Grid>
            </Frame>

            <!-- Módulo Cine -->
            <Frame Style="{StaticResource ModuleCardStyle}">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <Label Grid.Column="0"
                           Text="🎬"
                           FontSize="30"
                           VerticalOptions="Center"
                           Margin="0,0,15,0" />

                    <StackLayout Grid.Column="1"
                                 VerticalOptions="Center"
                                 Spacing="2">
                        <Label Text="Cine"
                               Style="{StaticResource ModuleTitleStyle}" />
                        <Label Text="Explora carteleras y horarios de cine"
                               Style="{StaticResource ModuleDescriptionStyle}" />
                    </StackLayout>

                    <Switch Grid.Column="2"
                            IsToggled="{Binding PreferenciasActuales.MostrarCine}"
                            Style="{StaticResource ModernSwitchStyle}" />
                </Grid>
            </Frame>

            <!-- Módulo Patrocinadores -->
            <Frame Style="{StaticResource ModuleCardStyle}">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <Label Grid.Column="0"
                           Text="🏢"
                           FontSize="30"
                           VerticalOptions="Center"
                           Margin="0,0,15,0" />

                    <StackLayout Grid.Column="1"
                                 VerticalOptions="Center"
                                 Spacing="2">
                        <Label Text="Patrocinadores"
                               Style="{StaticResource ModuleTitleStyle}" />
                        <Label Text="Conoce nuestros patrocinadores y colaboradores"
                               Style="{StaticResource ModuleDescriptionStyle}" />
                    </StackLayout>

                    <Switch Grid.Column="2"
                            IsToggled="{Binding PreferenciasActuales.MostrarPatrocinadores}"
                            Style="{StaticResource ModernSwitchStyle}" />
                </Grid>
            </Frame>

            <!-- Módulo Clientes -->
            <Frame Style="{StaticResource ModuleCardStyle}">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <Label Grid.Column="0"
                           Text="👥"
                           FontSize="30"
                           VerticalOptions="Center"
                           Margin="0,0,15,0" />

                    <StackLayout Grid.Column="1"
                                 VerticalOptions="Center"
                                 Spacing="2">
                        <Label Text="Clientes"
                               Style="{StaticResource ModuleTitleStyle}" />
                        <Label Text="Gestiona la información de tus clientes"
                               Style="{StaticResource ModuleDescriptionStyle}" />
                    </StackLayout>

                    <Switch Grid.Column="2"
                            IsToggled="{Binding PreferenciasActuales.MostrarClientes}"
                            Style="{StaticResource ModernSwitchStyle}" />
                </Grid>
            </Frame>

            <!-- Botones de acción -->
            <StackLayout Orientation="Horizontal" 
                         HorizontalOptions="FillAndExpand"
                         Spacing="10"
                         Margin="0,30,0,20">

                <!-- Guardar Cambios -->
                <Button Text="💾 Guardar Cambios"
                        BackgroundColor="#4CAF50"
                        TextColor="White"
                        CornerRadius="12"
                        FontAttributes="Bold"
                        HeightRequest="50"
                        HorizontalOptions="FillAndExpand"
                        Command="{Binding GuardarPreferenciasCommand}" />

                <!-- Restablecer Todos -->
                <Button Text="🔄 Activar Todos"
                        BackgroundColor="{AppThemeBinding Light=#2196F3, Dark=#1976D2}"
                        TextColor="White"
                        CornerRadius="12"
                        FontAttributes="Bold"
                        HeightRequest="50"
                        HorizontalOptions="FillAndExpand"
                        Command="{Binding ActivarTodosCommand}" />
            </StackLayout>

            <!-- Información adicional -->
            <Frame BackgroundColor="#E3F2FD"
                   CornerRadius="12"
                   HasShadow="False"
                   Padding="15"
                   Margin="0,0,0,20">

                <StackLayout Orientation="Horizontal" Spacing="10">
                    <Label Text="💡"
                           FontSize="20"
                           VerticalOptions="Center" />

                    <Label Text="Los módulos desactivados no aparecerán en tu página principal. Los cambios se guardan automáticamente."
                           FontSize="12"
                           TextColor="#1976D2"
                           VerticalOptions="Center"
                           LineBreakMode="WordWrap"
                           HorizontalOptions="FillAndExpand" />
                </StackLayout>
            </Frame>

            <!-- Botón Volver -->
            <Button Text="← Volver a Inicio"
                    BackgroundColor="{AppThemeBinding Light=#E0E0E0, Dark=#424242}"
                    TextColor="{AppThemeBinding Light=#424242, Dark=White}"
                    CornerRadius="12"
                    FontAttributes="Bold"
                    HeightRequest="45"
                    Clicked="btnVolver_Clicked"
                    Margin="0,10,0,15" />

        </StackLayout>
    </ScrollView>
</ContentPage>